import { Contract } from '../types/SolidityTypes';
import { VulnerabilityReport } from '../types/VulnerabilityReport';

export abstract class VulnerabilityAnalyzer {
    public contract: Contract;
    protected report: VulnerabilityReport;

    constructor(contract: Contract) {
        this.contract = contract;
        this.report = {
            vulnerabilities: [],
            warnings: [],
            suggestions: []
        };
    }

    abstract analyze(): VulnerabilityReport;

    protected addVulnerability(
        severity: 'HIGH' | 'MEDIUM' | 'LOW',
        title: string,
        description: string,
        location: { start: number; end: number },
        recommendation: string
    ) {
        this.report.vulnerabilities.push({
            severity,
            title,
            description,
            location,
            recommendation
        });
    }

    protected addWarning(
        title: string,
        description: string,
        location: { start: number; end: number },
        recommendation: string
    ) {
        this.report.warnings.push({
            title,
            description,
            location,
            recommendation
        });
    }

    protected addSuggestion(
        title: string,
        description: string,
        location: { start: number; end: number },
        recommendation: string
    ) {
        this.report.suggestions.push({
            title,
            description,
            location,
            recommendation
        });
    }
} 